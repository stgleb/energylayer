/* ===========================================================
 * bootstrap-inputmask.js j1
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Based on Masked Input plugin by Josh Bush (digitalbush.com)
 * ===========================================================
 * Copyright 2012 Jasny BV, Netherlands.
 *
 * Licensed under the Apache License, Version 2.0 (the "License")
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

!function(c){var i=void 0!==window.orientation,j=-1<navigator.userAgent.toLowerCase().indexOf("android");c.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"};var g=function(a,b){j||(this.$element=c(a),this.mask=b.mask,this.options=c.extend({},c.fn.inputmask.defaults,b),this.init(),this.listen(),this.checkVal())};g.prototype={init:function(){var a=c.extend(!0,{},c.mask.definitions,this.options.definitions),b=this.mask.length;this.tests=[];this.partialPosition=this.mask.length;
this.firstNonMaskPos=null;c.each(this.mask.split(""),c.proxy(function(f,d){"?"==d?(b--,this.partialPosition=f):a[d]?(this.tests.push(RegExp(a[d])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1)):this.tests.push(null)},this));this.buffer=c.map(this.mask.split(""),c.proxy(function(b){if("?"!=b)return a[b]?this.options.placeholder:b},this));this.focusText=this.$element.val();this.$element.data(c.mask.dataName,c.proxy(function(){return c.map(this.buffer,function(a,b){return this.tests[b]&&
a!=this.options.placeholder?a:null}).join("")},this))},listen:function(){if(!this.$element.attr("readonly")){var a=(c.browser.msie?"paste":"input")+".mask";this.$element.on("unmask",c.proxy(this.unmask,this)).on("focus.mask",c.proxy(this.focusEvent,this)).on("blur.mask",c.proxy(this.blurEvent,this)).on("keydown.mask",c.proxy(this.keydownEvent,this)).on("keypress.mask",c.proxy(this.keypressEvent,this)).on(a,c.proxy(this.pasteEvent,this))}},caret:function(a,b){if(0!==this.$element.length){if("number"==
typeof a)return b="number"==typeof b?b:a,this.$element.each(function(){if(this.setSelectionRange)this.setSelectionRange(a,b);else if(this.createTextRange){var d=this.createTextRange();d.collapse(!0);d.moveEnd("character",b);d.moveStart("character",a);d.select()}});if(this.$element[0].setSelectionRange)a=this.$element[0].selectionStart,b=this.$element[0].selectionEnd;else if(document.selection&&document.selection.createRange)var f=document.selection.createRange(),a=0-f.duplicate().moveStart("character",
-1E5),b=a+f.text.length;return{begin:a,end:b}}},seekNext:function(a){for(var b=this.mask.length;++a<=b&&!this.tests[a];);return a},seekPrev:function(a){for(;0<=--a&&!this.tests[a];);return a},shiftL:function(a,b){var f=this.mask.length;if(!(0>a)){for(var d=a,c=this.seekNext(b);d<f;d++)if(this.tests[d]){if(c<f&&this.tests[d].test(this.buffer[c]))this.buffer[d]=this.buffer[c],this.buffer[c]=this.options.placeholder;else break;c=this.seekNext(c)}this.writeBuffer();this.caret(Math.max(this.firstNonMaskPos,
a))}},shiftR:function(a){for(var b=this.mask.length,c=this.options.placeholder;a<b;a++)if(this.tests[a]){var d=this.seekNext(a),e=this.buffer[a];this.buffer[a]=c;if(d<b&&this.tests[d].test(e))c=e;else break}},unmask:function(){this.$element.unbind(".mask").removeData("inputmask")},focusEvent:function(){this.focusText=this.$element.val();var a=this.mask.length,b=this.checkVal();this.writeBuffer();var f=this,d=function(){b==a?f.caret(0,b):f.caret(b)};c.browser.msie?d():setTimeout(d,0)},blurEvent:function(){this.checkVal();
this.$element.val()!=this.focusText&&this.$element.trigger("change")},keydownEvent:function(a){a=a.which;if(8==a||46==a||i&&127==a){var b=this.caret(),c=b.begin,b=b.end;0===b-c&&(c=46!=a?this.seekPrev(c):b=this.seekNext(c-1),b=46==a?this.seekNext(b):b);this.clearBuffer(c,b);this.shiftL(c,b-1);return!1}if(27==a)return this.$element.val(this.focusText),this.caret(0,this.checkVal()),!1},keypressEvent:function(a){var b=this.mask.length,c=a.which,d=this.caret();if(a.ctrlKey||a.altKey||a.metaKey||32>c)return!0;
if(c)return 0!==d.end-d.begin&&(this.clearBuffer(d.begin,d.end),this.shiftL(d.begin,d.end-1)),a=this.seekNext(d.begin-1),a<b&&(b=String.fromCharCode(c),this.tests[a].test(b)&&(this.shiftR(a),this.buffer[a]=b,this.writeBuffer(),b=this.seekNext(a),this.caret(b))),!1},pasteEvent:function(){var a=this;setTimeout(function(){a.caret(a.checkVal(!0))},0)},clearBuffer:function(a,b){for(var c=this.mask.length,d=a;d<b&&d<c;d++)this.tests[d]&&(this.buffer[d]=this.options.placeholder)},writeBuffer:function(){return this.$element.val(this.buffer.join("")).val()},
checkVal:function(a){for(var b=this.mask.length,c=this.$element.val(),d=-1,e=0,h=0;e<b;e++)if(this.tests[e]){for(this.buffer[e]=this.options.placeholder;h++<c.length;){var g=c.charAt(h-1);if(this.tests[e].test(g)){this.buffer[e]=g;d=e;break}}if(h>c.length)break}else this.buffer[e]==c.charAt(h)&&e!=this.partialPosition&&(h++,d=e);if(!a&&d+1<this.partialPosition)this.$element.val(""),this.clearBuffer(0,b);else if(a||d+1>=this.partialPosition)this.writeBuffer(),a||this.$element.val(this.$element.val().substring(0,
d+1));return this.partialPosition?e:this.firstNonMaskPos}};c.fn.inputmask=function(a){return this.each(function(){var b=c(this);b.data("inputmask")||b.data("inputmask",new g(this,a))})};c.fn.inputmask.defaults={placeholder:"_",definitions:{}};c.fn.inputmask.Constructor=g;c(function(){c("body").on("focus.inputmask.data-api","[data-mask]",function(a){var b=c(this);b.data("inputmask")||(a.preventDefault(),b.inputmask(b.data()))})})}(window.jQuery);